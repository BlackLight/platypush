{% include 'plugins/media/search.html' %}
{% include 'plugins/media/controls.html' %}
{% include 'plugins/media/results.html' %}
{% include 'plugins/media/item.html' %}
{% include 'plugins/media/info.html' %}


{% for script in utils.search_directory(static_folder + '/js/plugins/media/handlers', 'js', recursive=True) %}
<script type="application/javascript" src="{{ url_for('static', filename='js/plugins/media/handlers/' + script) }}"></script>
{% endfor %}

<script type="text/x-template" id="tmpl-media">
    <div class="plugin media-plugin">
        <div class="search">
            <div class="col-11">
                <media-search :bus="bus"
                              :supportedTypes="types">
                </media-search>
            </div>

            <div class="col-1 pull-right">
                <media-devices :bus="bus"
                               :localPlayer="player">
                </media-devices>
            </div>
        </div>

        <media-results :bus="bus"
                       :status="selectedDevice && status[selectedDevice.type] && status[selectedDevice.type][selectedDevice.name] ? status[selectedDevice.type][selectedDevice.name] : {}"
                       :searching="loading.results"
                       :loading="loading.media"
                       :resize="selectedDevice && status[selectedDevice.type] && status[selectedDevice.type][selectedDevice.name] && (status[selectedDevice.type][selectedDevice.name].state === 'play' || status[selectedDevice.type][selectedDevice.name].state === 'pause')"
                       :results="results">
        </media-results>

        <media-controls :bus="bus"
                        :status="selectedDevice && status[selectedDevice.type] && status[selectedDevice.type][selectedDevice.name] ? status[selectedDevice.type][selectedDevice.name] : {}"
                        v-if="selectedDevice && status[selectedDevice.type] && status[selectedDevice.type][selectedDevice.name] && (status[selectedDevice.type][selectedDevice.name].state === 'play' || status[selectedDevice.type][selectedDevice.name].state === 'pause')">
        </media-controls>

        <modal id="media-info" title="Media info" v-model="infoModal.visible" ref="modalInfo">
            <div class="loading" v-if="infoModal.loading">Loading</div>
            <media-info :bus="bus" :item="infoModal.item" v-else></media-info>
        </modal>
    </div>
</script>

