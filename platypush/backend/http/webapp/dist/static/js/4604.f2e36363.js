"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[4604],{4212:function(e,t,s){s.d(t,{N:function(){return i}});class i{constructor(e){if(this.ranges={hue:[0,360],sat:[0,100],bri:[0,100],ct:[154,500]},e)for(const t of Object.keys(this.ranges))e[t]&&(this.ranges[t]=e[t])}normalize(e,t,s){return s[0]+(e-t[0])*(s[1]-s[0])/(t[1]-t[0])}hslToRgb(e,t,s){[e,t,s]=[this.normalize(e,this.ranges.hue,[0,360]),this.normalize(t,this.ranges.sat,[0,100]),this.normalize(s,this.ranges.bri,[0,100])],s/=100;const i=t*Math.min(s,1-s)/100,a=t=>{const a=(t+e/30)%12,n=s-i*Math.max(Math.min(a-3,9-a,1),-1);return Math.round(255*n)};return[a(0),a(8),a(4)]}rgbToHsl(e,t,s){e/=255,t/=255,s/=255;const i=Math.max(e,t,s),a=Math.min(e,t,s);let n,l,o=(i+a)/2;if(i===a)n=l=0;else{const r=i-a;switch(l=o>.5?r/(2-i-a):r/(i+a),i){case e:n=(t-s)/r+(t<s?6:0);break;case t:n=(s-e)/r+2;break;case s:n=(e-t)/r+4;break}n/=6}return[parseInt(this.normalize(n,[0,1],this.ranges.hue)),parseInt(this.normalize(l,[0,1],this.ranges.sat)),parseInt(this.normalize(o,[0,1],this.ranges.bri))]}xyToRgb(e,t,s){null==s&&(s=this.ranges.bri[1]);const i=1-e-t,a=(s/(this.ranges.bri[1]-1)).toFixed(2),n=a/t*e,l=a/t*i;let o=1.656492*n-.354851*a-.255038*l,r=.707196*-n+1.655397*a+.036152*l,d=.051713*n-.121364*a+1.01153*l;return o>d&&o>r&&o>1?(r/=o,d/=o,o=1):r>d&&r>o&&r>1?(o/=r,d/=r,r=1):d>o&&d>r&&d>1&&(o/=d,r/=d,d=1),o=o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055,r=r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055,d=d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055,o=Math.round(255*o),r=Math.round(255*r),d=Math.round(255*d),isNaN(o)&&(o=0),isNaN(r)&&(r=0),isNaN(d)&&(d=0),[o,r,d].map((e=>Math.min(Math.max(0,e),255)))}rgbToXY(e,t,s){e>1&&(e/=255),t>1&&(t/=255),s>1&&(s/=255),e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;const i=.664511*e+.154324*t+.162028*s,a=.283881*e+.668433*t+.047685*s,n=88e-6*e+.07231*t+.986039*s;let l=parseFloat((i/(i+a+n)).toFixed(4)),o=parseFloat((a/(i+a+n)).toFixed(4));return isNaN(l)&&(l=0),isNaN(o)&&(o=0),[l,o]}rgbToBri(e,t,s){return Math.min(2*this.rgbToHsl(e,t,s)[2],this.ranges.bri[1])}getRGB(e){return null!=e.red&&null!=e.green&&null!=e.blue?[e.red,e.green,e.blue]:null!=e.r&&null!=e.g&&null!=e.b?[e.r,e.g,e.b]:e.rgb?e.rgb:void 0}getXY(e){return null!=e.x&&null!=e.y?[e.x,e.y]:e.xy?e.xy:void 0}toRGB(e){const t=this.getRGB(e);if(t)return t;const s=this.getXY(e);return s&&e.bri?this.xyToRgb(...s,e.bri):e.hue&&e.sat&&e.bri?this.hslToRgb(e.hue,e.sat,e.bri):(console.debug("Could not determine color space"),void console.debug(e))}toXY(e){const t=this.getXY(e);if(t&&e.bri)return[t[0],t[1],e.bri];const s=this.getRGB(e);if(s)return this.rgbToXY(...s);if(e.hue&&e.sat&&e.bri){const t=this.hslToRgb(e.hue,e.sat,e.bri);return this.rgbToXY(...t)}console.debug("Could not determine color space"),console.debug(e)}toHSL(e){if(e.hue&&e.sat&&e.bri)return[e.hue,e.sat,e.bri];const t=this.getRGB(e);if(t)return this.rgbToHsl(...t);const s=this.getXY(e);if(s&&e.bri){const t=this.xyToRgb(...s,e.bri);return this.rgbToHsl(...t)}console.debug("Could not determine color space"),console.debug(e)}}},542:function(e,t,s){s.d(t,{Z:function(){return c}});var i=s(6252),a=s(3577);const n=["min","max","value","disabled"],l=["textContent"];function o(e,t,s,o,r,d){return(0,i.wg)(),(0,i.iD)("label",null,[(0,i._)("input",{class:"slider",type:"range",min:s.range[0],max:s.range[1],value:s.value,disabled:s.disabled,onChange:t[0]||(t[0]=t=>e.$emit("input",t)),onMouseup:t[1]||(t[1]=t=>e.$emit("mouseup",t)),onInput:t[2]||(t[2]=t=>e.$emit("input",t)),onMousedown:t[3]||(t[3]=t=>e.$emit("mousedown",t)),onTouch:t[4]||(t[4]=t=>e.$emit("input",t)),onTouchstart:t[5]||(t[5]=t=>e.$emit("mousedown",t)),onTouchend:t[6]||(t[6]=t=>e.$emit("mouseup",t))},null,40,n),s.withLabel?((0,i.wg)(),(0,i.iD)("span",{key:0,class:"label",textContent:(0,a.zw)(s.value)},null,8,l)):(0,i.kq)("",!0)])}var r={name:"Slider",emits:["input","mouseup","mousedown"],props:{value:{type:Number},disabled:{type:Boolean,default:!1},range:{type:Array,default:()=>[0,100]},withLabel:{type:Boolean,default:!1}}},d=s(3744);const u=(0,d.Z)(r,[["render",o],["__scopeId","data-v-1a18952e"]]);var c=u},3567:function(e,t,s){s.d(t,{Z:function(){return m}});var i=s(6252),a=s(3577);const n=e=>((0,i.dD)("data-v-8fae7678"),e=e(),(0,i.Cn)(),e),l=["checked"],o=n((()=>(0,i._)("div",{class:"switch"},[(0,i._)("div",{class:"dot"})],-1))),r={class:"label"};function d(e,t,s,n,d,u){return(0,i.wg)(),(0,i.iD)("div",{class:(0,a.C_)(["power-switch",{disabled:s.disabled}]),onClick:t[0]||(t[0]=(...e)=>u.onInput&&u.onInput(...e))},[(0,i._)("input",{type:"checkbox",checked:s.value},null,8,l),(0,i._)("label",null,[o,(0,i._)("span",r,[(0,i.WI)(e.$slots,"default",{},void 0,!0)])])],2)}var u={name:"ToggleSwitch",emits:["input"],props:{value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{onInput(e){if(e.stopPropagation(),this.disabled)return!1;this.$emit("input",e)}}},c=s(3744);const v=(0,c.Z)(u,[["render",d],["__scopeId","data-v-8fae7678"]]);var m=v},4604:function(e,t,s){s.r(t),s.d(t,{default:function(){return vs}});var i=s(6252),a=s(3577);const n={class:"zigbee-container"},l={key:0,class:"info-body"},o={class:"row"},r=(0,i._)("div",{class:"param-name"},"State",-1),d=["textContent"],u={class:"row"},c=(0,i._)("div",{class:"param-name"},"Permit Join",-1),v=["textContent"],m={key:0,class:"row"},p=(0,i._)("div",{class:"param-name"},"Network Channel",-1),h=["textContent"],g={class:"row"},b=(0,i._)("div",{class:"param-name"},"Zigbee2MQTT Version",-1),y=["textContent"],f={key:1,class:"row"},_=(0,i._)("div",{class:"param-name"},"MQTT Server",-1),w=["textContent"],k={key:2,class:"row"},q=(0,i._)("div",{class:"param-name"},"Serial Port",-1),C=["textContent"],x={key:3,class:"row"},z=(0,i._)("div",{class:"param-name"},"Firmware Type",-1),D=["textContent"],M={key:4,class:"row"},G=(0,i._)("div",{class:"param-name"},"Firmware Version",-1),Z={class:"param-value"},R={key:5,class:"row"},I=(0,i._)("div",{class:"param-name"},"Firmware Revision",-1),N=["textContent"],T={class:"view-options"},V={class:"view-selector col-s-8 col-m-9 col-l-10"},E=["value"],j=["textContent","selected","value"],A={class:"buttons"},S=["disabled"],$=(0,i._)("i",{class:"fa fa-plus"},null,-1),O=[$],F=["disabled"],B=(0,i._)("i",{class:"fa fa-sync-alt"},null,-1),Y=[B],L={class:"view-container"},U={key:0,class:"view devices"},H={key:0,class:"no-items"},P={key:0,class:"loading"},X={key:1,class:"empty"},W={key:1,class:"view groups"},J={key:0,class:"no-items"},K={key:0,class:"loading"},Q={key:1,class:"empty"};function ee(e,t,s,$,B,ee){const te=(0,i.up)("Loading"),se=(0,i.up)("Modal"),ie=(0,i.up)("DropdownItem"),ae=(0,i.up)("Dropdown"),ne=(0,i.up)("Device"),le=(0,i.up)("Group");return(0,i.wg)(),(0,i.iD)("div",n,[B.loading?((0,i.wg)(),(0,i.j4)(te,{key:0})):(0,i.kq)("",!0),(0,i.Wm)(se,{title:"Network Info",ref:"infoModal"},{default:(0,i.w5)((()=>[B.status.info?((0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",o,[r,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.state)},null,8,d)]),(0,i._)("div",u,[c,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.permit_join)},null,8,v)]),B.status.info.network?((0,i.wg)(),(0,i.iD)("div",m,[p,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.network.channel)},null,8,h)])):(0,i.kq)("",!0),(0,i._)("div",g,[b,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.version)},null,8,y)]),B.status.info.config?.mqtt?((0,i.wg)(),(0,i.iD)("div",f,[_,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.config.mqtt.server)},null,8,w)])):(0,i.kq)("",!0),B.status.info.config?.serial?((0,i.wg)(),(0,i.iD)("div",k,[q,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.config.serial.port)},null,8,C)])):(0,i.kq)("",!0),B.status.info.coordinator?.type?((0,i.wg)(),(0,i.iD)("div",x,[z,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.coordinator.type)},null,8,D)])):(0,i.kq)("",!0),B.status.info.coordinator?.meta?((0,i.wg)(),(0,i.iD)("div",M,[G,(0,i._)("div",Z,(0,a.zw)(B.status.info.coordinator.meta.maintrel)+"."+(0,a.zw)(B.status.info.coordinator.meta.majorrel)+"."+(0,a.zw)(B.status.info.coordinator.meta.minorrel),1)])):(0,i.kq)("",!0),B.status.info.coordinator?.meta?((0,i.wg)(),(0,i.iD)("div",R,[I,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.coordinator.meta.revision)},null,8,N)])):(0,i.kq)("",!0)])):(0,i.kq)("",!0)])),_:1},512),(0,i._)("div",T,[(0,i._)("div",V,[(0,i._)("label",null,[(0,i._)("select",{value:B.selected.view,onChange:t[0]||(t[0]=e=>this.selected.view=e.target.value)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.views,((e,t)=>((0,i.wg)(),(0,i.iD)("option",{textContent:(0,a.zw)((t[0].toUpperCase()+t.slice(1)).replace("_"," ")),key:t,selected:e,value:t},null,8,j)))),128))],40,E)])]),(0,i._)("div",A,["groups"===B.selected.view?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"btn btn-default",title:"Add Group",disabled:B.loading,onClick:t[1]||(t[1]=(...e)=>ee.addGroup&&ee.addGroup(...e))},O,8,S)):(0,i.kq)("",!0),(0,i.Wm)(ae,{ref:"networkCommandsDropdown","icon-class":"fa fa-cog",title:"Network commands"},{default:(0,i.w5)((()=>[(0,i.Wm)(ie,{text:"Network Info",disabled:B.loading,onClick:t[2]||(t[2]=t=>e.$refs.infoModal.show())},null,8,["disabled"]),B.status.info?.permit_join?((0,i.wg)(),(0,i.j4)(ie,{key:1,text:"Disable Join",disabled:B.loading,onClick:t[4]||(t[4]=e=>ee.permitJoin(!1))},null,8,["disabled"])):((0,i.wg)(),(0,i.j4)(ie,{key:0,text:"Permit Join",disabled:B.loading,onClick:t[3]||(t[3]=e=>ee.permitJoin(!0))},null,8,["disabled"])),(0,i.Wm)(ie,{text:"Factory Reset",disabled:B.loading,onClick:ee.factoryReset},null,8,["disabled","onClick"])])),_:1},512),(0,i._)("button",{class:"btn btn-default",title:"Refresh network",disabled:B.loading,onClick:t[5]||(t[5]=(...e)=>ee.refresh&&ee.refresh(...e))},Y,8,F)])]),(0,i._)("div",L,["devices"===B.selected.view?((0,i.wg)(),(0,i.iD)("div",U,[Object.keys(B.devices).length?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",H,[B.loading?((0,i.wg)(),(0,i.iD)("div",P,"Loading devices...")):((0,i.wg)(),(0,i.iD)("div",X,"No devices found on the network"))])),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.devices,((e,t)=>((0,i.wg)(),(0,i.j4)(ne,{key:t,device:e,groups:B.groups,selected:B.selected.deviceId===t,onSelect:e=>B.selected.deviceId=B.selected.deviceId===t?null:t,onRename:ee.refreshDevices,onRemove:ee.refreshDevices,onGroupsEdit:ee.refreshGroups},null,8,["device","groups","selected","onSelect","onRename","onRemove","onGroupsEdit"])))),128))])):"groups"===B.selected.view?((0,i.wg)(),(0,i.iD)("div",W,[Object.keys(B.groups).length?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",J,[B.loading?((0,i.wg)(),(0,i.iD)("div",K,"Loading groups...")):((0,i.wg)(),(0,i.iD)("div",Q,"No groups available on the network"))])),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.groups,((e,t)=>((0,i.wg)(),(0,i.j4)(le,{key:t,group:e,devices:B.devices,selected:B.selected.groupId===t,onSelect:e=>B.selected.groupId=B.selected.groupId===t?null:t,onRename:ee.refreshGroups,onRemove:ee.refreshGroups,onEdit:ee.refreshGroups},null,8,["group","devices","selected","onSelect","onRename","onRemove","onEdit"])))),128))])):(0,i.kq)("",!0)])])}var te=s(7021),se=s(455),ie=s(1232),ae=s(2628),ne=s(9963);const le=e=>((0,i.dD)("data-v-b05d09fc"),e=e(),(0,i.Cn)(),e),oe={class:"groups"},re=["value","checked"],de=["textContent"],ue=le((()=>(0,i._)("div",{class:"footer buttons"},[(0,i._)("button",{type:"submit"},"Save")],-1))),ce=["textContent"],ve={key:1,class:"params"},me={class:"row"},pe=le((()=>(0,i._)("div",{class:"param-name"},"Name",-1))),he={class:"param-value"},ge=["value"],be={class:"buttons"},ye=le((()=>(0,i._)("i",{class:"fas fa-times"},null,-1))),fe=[ye],_e=le((()=>(0,i._)("button",{type:"submit",class:"btn btn-default"},[(0,i._)("i",{class:"fa fa-check"})],-1))),we=["textContent"],ke={class:"buttons"},qe=le((()=>(0,i._)("i",{class:"fa fa-edit"},null,-1))),Ce=[qe],xe={class:"row"},ze=le((()=>(0,i._)("div",{class:"param-name"},"IEEE Address",-1))),De=["textContent"],Me={key:0,class:"row"},Ge=le((()=>(0,i._)("div",{class:"param-name"},"Network Address",-1))),Ze=["textContent"],Re={class:"row"},Ie=le((()=>(0,i._)("div",{class:"param-name"},"Type",-1))),Ne=["textContent"],Te={key:1,class:"row"},Ve=le((()=>(0,i._)("div",{class:"param-name"},"Vendor",-1))),Ee={class:"param-value"},je={key:2,class:"row"},Ae=le((()=>(0,i._)("div",{class:"param-name"},"Model",-1))),Se={class:"param-value"},$e={key:3,class:"row"},Oe=le((()=>(0,i._)("div",{class:"param-name"},"Model ID",-1))),Fe={class:"param-value"},Be={key:4,class:"row"},Ye=le((()=>(0,i._)("div",{class:"param-name"},"Description",-1))),Le={class:"param-value"},Ue={key:5,class:"row"},He=le((()=>(0,i._)("div",{class:"param-name"},"Software Build ID",-1))),Pe={class:"param-value"},Xe={key:6,class:"row"},We=le((()=>(0,i._)("div",{class:"param-name"},"Date Code",-1))),Je={class:"param-value"},Ke={key:7,class:"row"},Qe=le((()=>(0,i._)("div",{class:"param-name"},"Power Source",-1))),et={class:"param-value"},tt={key:8,class:"section values"},st=le((()=>(0,i._)("div",{class:"header"},[(0,i._)("div",{class:"title"},"Values")],-1))),it={class:"body"},at={class:"param-name"},nt={key:0,class:"text"},lt=["textContent"],ot=["textContent"],rt={class:"param-value"},dt={key:2},ut=["value","disabled","onChange"],ct={key:3},vt=["value","onChange"],mt={key:0},pt=["value","textContent","selected","disabled"],ht={key:4},gt=["onChange","value"],bt={key:5},yt=["disabled","value","onChange"],ft={class:"section actions"},_t=le((()=>(0,i._)("div",{class:"header"},[(0,i._)("div",{class:"title"},"Actions")],-1))),wt={class:"body"},kt=le((()=>(0,i._)("div",{class:"param-name"},"Manage groups",-1))),qt=le((()=>(0,i._)("div",{class:"param-value"},[(0,i._)("i",{class:"fa fa-network-wired"})],-1))),Ct=[kt,qt],xt={key:0,class:"param-name"},zt={key:1,class:"param-name"},Dt=le((()=>(0,i._)("div",{class:"param-value"},[(0,i._)("i",{class:"fa fa-sync-alt"})],-1))),Mt=le((()=>(0,i._)("div",{class:"param-name"},"Remove Device",-1))),Gt=le((()=>(0,i._)("div",{class:"param-value"},[(0,i._)("i",{class:"fa fa-trash"})],-1))),Zt=[Mt,Gt],Rt=le((()=>(0,i._)("div",{class:"param-name"},"Force Remove Device",-1))),It=le((()=>(0,i._)("div",{class:"param-value"},[(0,i._)("i",{class:"fa fa-trash"})],-1))),Nt=[Rt,It];function Tt(e,t,s,n,l,o){const r=(0,i.up)("Loading"),d=(0,i.up)("Modal"),u=(0,i.up)("ToggleSwitch"),c=(0,i.up)("Slider");return(0,i.wg)(),(0,i.iD)("div",{class:(0,a.C_)(["item device",{selected:s.selected}])},[l.loading?((0,i.wg)(),(0,i.j4)(r,{key:0})):(0,i.kq)("",!0),(0,i.Wm)(d,{class:"groups-modal",ref:"groupsModal",title:"Device groups"},{default:(0,i.w5)((()=>[l.loading?((0,i.wg)(),(0,i.j4)(r,{key:0})):(0,i.kq)("",!0),(0,i._)("form",{class:"content",onSubmit:t[0]||(t[0]=(0,ne.iM)(((...e)=>o.manageGroups&&o.manageGroups(...e)),["prevent"]))},[(0,i._)("div",oe,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.groups,((e,t)=>((0,i.wg)(),(0,i.iD)("label",{class:"row group",key:t},[(0,i._)("input",{type:"checkbox",value:t,checked:o.associatedGroups.has(parseInt(e.id))},null,8,re),(0,i._)("span",{class:"name",textContent:(0,a.zw)(e.friendly_name?.length?e.friendly_name:`[Group #${e.id}]`)},null,8,de)])))),128))]),ue],32)])),_:1},512),(0,i._)("div",{class:(0,a.C_)(["row name header vertical-center",{selected:s.selected}]),textContent:(0,a.zw)(s.device.friendly_name||s.device.ieee_address),onClick:t[1]||(t[1]=t=>e.$emit("select"))},null,10,ce),s.selected?((0,i.wg)(),(0,i.iD)("div",ve,[(0,i._)("div",me,[pe,(0,i._)("div",he,[(0,i._)("div",{class:(0,a.C_)(["name-edit",{hidden:!l.editName}])},[(0,i._)("form",{onSubmit:t[3]||(t[3]=(0,ne.iM)(((...e)=>o.rename&&o.rename(...e)),["prevent"]))},[(0,i._)("label",null,[(0,i._)("input",{type:"text",name:"name",ref:"name",value:s.device.friendly_name},null,8,ge)]),(0,i._)("span",be,[(0,i._)("button",{type:"button",class:"btn btn-default",onClick:t[2]||(t[2]=e=>l.editName=!1)},fe),_e])],32)],2),(0,i._)("div",{class:(0,a.C_)(["name-edit",{hidden:l.editName}])},[(0,i._)("span",{textContent:(0,a.zw)(s.device.friendly_name)},null,8,we),(0,i._)("span",ke,[(0,i._)("button",{type:"button",class:"btn btn-default",onClick:t[4]||(t[4]=e=>l.editName=!0)},Ce)])],2)])]),(0,i._)("div",xe,[ze,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(s.device.ieee_address)},null,8,De)]),s.device.network_address?((0,i.wg)(),(0,i.iD)("div",Me,[Ge,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(s.device.network_address)},null,8,Ze)])):(0,i.kq)("",!0),(0,i._)("div",Re,[Ie,(0,i._)("div",{class:"param-value",textContent:(0,a.zw)(s.device.type)},null,8,Ne)]),s.device.definition?.vendor?((0,i.wg)(),(0,i.iD)("div",Te,[Ve,(0,i._)("div",Ee,(0,a.zw)(s.device.definition.vendor),1)])):(0,i.kq)("",!0),s.device.definition?.model?((0,i.wg)(),(0,i.iD)("div",je,[Ae,(0,i._)("div",Se,(0,a.zw)(s.device.definition.model),1)])):(0,i.kq)("",!0),s.device.model_id?((0,i.wg)(),(0,i.iD)("div",$e,[Oe,(0,i._)("div",Fe,(0,a.zw)(s.device.model_id),1)])):(0,i.kq)("",!0),s.device.definition?.description?((0,i.wg)(),(0,i.iD)("div",Be,[Ye,(0,i._)("div",Le,(0,a.zw)(s.device.definition.description),1)])):(0,i.kq)("",!0),s.device.software_build_id?((0,i.wg)(),(0,i.iD)("div",Ue,[He,(0,i._)("div",Pe,(0,a.zw)(s.device.software_build_id),1)])):(0,i.kq)("",!0),s.device.definition?.date_code?((0,i.wg)(),(0,i.iD)("div",Xe,[We,(0,i._)("div",Je,(0,a.zw)(s.device.definition.date_code),1)])):(0,i.kq)("",!0),s.device.power_source?((0,i.wg)(),(0,i.iD)("div",Ke,[Qe,(0,i._)("div",et,(0,a.zw)(s.device.power_source),1)])):(0,i.kq)("",!0),Object.keys(o.displayedValues).length?((0,i.wg)(),(0,i.iD)("div",tt,[st,(0,i._)("div",it,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.displayedValues,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"row value",key:t},[(0,i._)("div",at,[(0,i.Uk)((0,a.zw)(e.description)+" ",1),null!=o.rgbColor&&null!=e.value?.x&&null!=e.value?.y||null!=e.value?.hue&&null!=e.value?.saturation?((0,i.wg)(),(0,i.iD)("span",nt,"Color")):(0,i.kq)("",!0),e.property?((0,i.wg)(),(0,i.iD)("span",{key:1,class:"name",textContent:(0,a.zw)(e.property)},null,8,lt)):(0,i.kq)("",!0),e.unit?((0,i.wg)(),(0,i.iD)("span",{key:2,class:"unit",textContent:(0,a.zw)(e.unit)},null,8,ot)):(0,i.kq)("",!0)]),(0,i._)("div",rt,["binary"===e.type?((0,i.wg)(),(0,i.j4)(u,{key:0,value:null!=e.value_on?e.value===e.value_on:!!e.value,disabled:!e.writable,onInput:t=>o.setValue(e,t)},null,8,["value","disabled","onInput"])):"numeric"===e.type&&null!=e.value_min&&null!=e.value_max?((0,i.wg)(),(0,i.j4)(c,{key:1,"with-label":!0,range:[e.value_min,e.value_max],value:e.value,disabled:!e.writable,onChange:t=>o.setValue(e,t)},null,8,["range","value","disabled","onChange"])):"numeric"!==e.type||null!=e.value_min&&null!=e.value_max?"enum"===e.type?((0,i.wg)(),(0,i.iD)("label",ct,[(0,i._)("select",{value:e.readable&&null!=e.value?e.value:"",onChange:t=>o.setValue(e,t)},[e.readable?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("option",mt)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.values,(t=>((0,i.wg)(),(0,i.iD)("option",{key:t,value:t,textContent:(0,a.zw)(t),selected:e.readable&&e.value===t,disabled:!e.writable},null,8,pt)))),128))],40,vt)])):null!=o.rgbColor&&null!=e.value?.x&&null!=e.value?.y||null!=e.value?.hue&&null!=e.value?.saturation?((0,i.wg)(),(0,i.iD)("label",ht,[(0,i._)("input",{type:"color",onChange:(0,ne.iM)((t=>o.setValue(e,t)),["stop"]),value:"#"+o.rgbColor.map((e=>(e=Number(e).toString(16),1===e.length?"0"+e:e))).join("")},null,40,gt)])):((0,i.wg)(),(0,i.iD)("label",bt,[(0,i._)("input",{type:"text",disabled:!e.writable,value:e.value,onChange:t=>o.setValue(e,t)},null,40,yt)])):((0,i.wg)(),(0,i.iD)("label",dt,[(0,i._)("input",{type:"number","with-label":!0,value:e.value,disabled:!e.writable,onChange:t=>o.setValue(e,t)},null,40,ut)]))])])))),128))])])):(0,i.kq)("",!0),(0,i._)("div",ft,[_t,(0,i._)("div",wt,[(0,i._)("div",{class:"row",onClick:t[5]||(t[5]=t=>e.$refs.groupsModal.show())},Ct),(0,i._)("div",{class:"row",onClick:t[6]||(t[6]=e=>l.otaUpdatesAvailable?o.installOtaUpdates():o.checkOtaUpdates())},[l.otaUpdatesAvailable?((0,i.wg)(),(0,i.iD)("div",zt,"Install updates")):((0,i.wg)(),(0,i.iD)("div",xt,"Check for updates")),Dt]),(0,i._)("div",{class:"row",onClick:t[7]||(t[7]=e=>o.remove(!1))},Zt),(0,i._)("div",{class:"row error",onClick:t[8]||(t[8]=e=>o.remove(!0))},Nt)])])])):(0,i.kq)("",!0)],2)}var Vt=s(542),Et=s(3567),jt=s(4212),At=s(9642),St={name:"Device",components:{Modal:At.Z,ToggleSwitch:Et.Z,Slider:Vt.Z,Loading:ie.Z},mixins:[ae.Z],emits:["select","rename","remove","groups-edit"],props:{device:{type:Object,required:!0},groups:{type:Object,default:()=>{}},selected:{type:Boolean,default:!1}},data(){return{editName:!1,loading:!1,status:{},otaUpdatesAvailable:!1}},computed:{values(){if(!this.device.definition?.exposes)return{};const e=e=>{const t=(e,s)=>{if(e.features){e.property&&(s[e.property]=s[e.property]||{},s=s[e.property]);for(const i of e.features)t(i,s)}else e.property&&(s[e.property]=e)},s={};for(const i of e)t(i,s);return s};return e(this.device.definition.exposes)},displayedValues(){const e={},t=(e,[s,i])=>(s in this.status&&(i={...i,value:this.status[s]}),null!=i.access&&(i.readable=!!(1&i.access),i.writable=!!(2&i.access),delete i.access),e[s]=i,Object.entries(i).filter((e=>e[1]instanceof Object)).reduce(t,e[s]),e);return Object.entries(this.values).reduce(t,e),e},rgbColor(){if(!this.displayedValues.color)return;const e=this.displayedValues.color?.value;if(e){if(null!=e.x&&null!=e.y){const t=new jt.N({bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]});return t.xyToRgb(e.x,e.y,this.displayedValues.brightness.value)}if(null!=e.hue&&(null!=e.saturation||null!=e.sat)){const t=null!=e.saturation?"saturation":"sat",s=new jt.N({hue:[this.displayedValues.color.hue?.value_min||0,this.displayedValues.color.hue.value_max||65535],sat:[this.displayedValues.color[t]?.value_min||0,this.displayedValues.color[t].value_max||255],bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]});return s.hslToRgb(e.hue,e[t],this.displayedValues.brightness.value)}return null}},associatedGroups(){return new Set(Object.values(this.groups).filter((e=>new Set((e.members||[]).map((e=>e.ieee_address))).has(this.device.ieee_address))).map((e=>parseInt(e.id))))}},methods:{async refresh(){this.loading=!0;try{this.status=await this.request("zigbee.mqtt.device_get",{device:this.device.friendly_name||this.device.ieee_address})}finally{this.loading=!1}},async rename(){const e=(this.$refs.name.value||"").trim();if(e.length&&e!==this.device.friendly_name){this.loading=!0;try{await this.request("zigbee.mqtt.device_rename",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address,name:e}),this.$emit("rename",{name:this.device.friendly_name,newName:e})}finally{this.editName=!1,this.loading=!1}}},async remove(e){if(confirm("Are you really sure that you want to remove this device from the network?")){e=!!e,this.loading=!0;try{await this.request("zigbee.mqtt.device_remove",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address,force:e}),this.$emit("remove",{device:this.device.friendly_name||this.device.ieee_address})}finally{this.loading=!1}}},async setValue(e,t){const s={device:this.device.friendly_name||this.device.ieee_address,property:e.property,value:null};switch(e.type){case"binary":e.value_toggle?s.value=e.value_toggle:e.value_on&&e.value_off?s.value=e.value===e.value_on?e.value_off:e.value_on:s.value=!e.value;break;case"numeric":s.value=parseFloat(t.target.value);break;case"enum":t.target.value?.length&&(s.value=t.target.value);break;default:if(null!=e.x&&null!=e.y||null!=e.hue&&(null!=e.saturation||null!=e.sat)){s.property="color";const i=t.target.value.slice(1).split(/([0-9a-fA-F]{2})/).filter(((e,t)=>t%2)).map((e=>parseInt(e,16)));if(null!=e.x&&null!=e.y){const e=new jt.N({bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]}),t=e.rgbToXY(...i);s.value={color:{x:t[0],y:t[1]}}}else{const e=null!=this.displayedValues.color.saturation?"saturation":"sat",t=new jt.N({hue:[this.displayedValues.color.hue?.value_min||0,this.displayedValues.color.hue.value_max||65535],sat:[this.displayedValues.color[e]?.value_min||0,this.displayedValues.color[e].value_max||255],bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]}),a=t.rgbToHsl(...i);s.value={brightness:a[2],color:{hue:a[0]}},s.value.color[e]=a[1]}}break}if(null!=s.value){this.loading=!0;try{await this.request("zigbee.mqtt.device_set",s),await this.refresh()}finally{this.loading=!1}}},async manageGroups(e){const t=[...e.target.querySelectorAll("input[type=checkbox]")].reduce(((e,t)=>{const s=parseInt(t.value);return t.checked&&!this.associatedGroups.has(s)?e.add.add(s):!t.checked&&this.associatedGroups.has(s)&&e.remove.add(s),e}),{add:new Set,remove:new Set}),s=async e=>{await Promise.all([...t[e]].map((async t=>{await this.request(`zigbee.mqtt.group_${e}_device`,{group:this.groups[t].friendly_name,device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})})))};this.loading=!0;try{await Promise.all(Object.keys(t).map(s)),this.$emit("groups-edit",t)}finally{this.loading=!1}},async checkOtaUpdates(){this.loading=!0;try{this.otaUpdatesAvailable=(await this.request("zigbee.mqtt.device_check_ota_updates",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})).update_available,this.otaUpdatesAvailable?this.notify({text:"A firmware update is available for the device",image:{iconClass:"fa fa-sync-alt"}}):this.notify({text:"The device is up to date",image:{iconClass:"fa fa-check"}})}finally{this.loading=!1}},async installOtaUpdates(){this.loading=!0;try{await this.request("zigbee.mqtt.device_install_ota_updates",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})}finally{this.loading=!1}}},mounted(){this.$watch((()=>this.selected),(e=>{e&&this.refresh()})),this.$watch((()=>this.status.update_available),(e=>{this.otaUpdatesAvailable=e})),this.subscribe((e=>{e.device!==this.device.friendly_name&&e.device!==this.device.ieee_address||(this.status={...this.status,...e.properties})}),`on-property-change-${this.device.ieee_address}`,"platypush.message.event.zigbee.mqtt.ZigbeeMqttDevicePropertySetEvent")},unmounted(){this.unsubscribe(`on-property-change-${this.device.ieee_address}`)}},$t=s(3744);const Ot=(0,$t.Z)(St,[["render",Tt],["__scopeId","data-v-b05d09fc"]]);var Ft=Ot;const Bt=e=>((0,i.dD)("data-v-7667f7ba"),e=e(),(0,i.Cn)(),e),Yt=["textContent"],Lt={key:1,class:"params"},Ut={class:"section devices"},Ht=Bt((()=>(0,i._)("div",{class:"header"},[(0,i._)("div",{class:"title"},"Devices")],-1))),Pt={class:"body"},Xt=["checked","value","onChange"],Wt=["textContent"],Jt={class:"section actions"},Kt=Bt((()=>(0,i._)("div",{class:"header"},[(0,i._)("div",{class:"title"},"Actions")],-1))),Qt={class:"body"},es=Bt((()=>(0,i._)("div",{class:"col-10"},"Rename Group",-1))),ts=Bt((()=>(0,i._)("div",{class:"buttons col-2 pull-right"},[(0,i._)("i",{class:"fa fa-edit"})],-1))),ss=[es,ts],is=Bt((()=>(0,i._)("div",{class:"col-10"},"Remove Group",-1))),as=Bt((()=>(0,i._)("div",{class:"buttons col-2 pull-right"},[(0,i._)("i",{class:"fa fa-trash"})],-1))),ns=[is,as];function ls(e,t,s,n,l,o){const r=(0,i.up)("Loading");return(0,i.wg)(),(0,i.iD)("div",{class:(0,a.C_)(["item group",{selected:s.selected}])},[l.loading?((0,i.wg)(),(0,i.j4)(r,{key:0})):(0,i.kq)("",!0),(0,i._)("div",{class:(0,a.C_)(["row name header vertical-center",{selected:s.selected}]),textContent:(0,a.zw)(s.group.friendly_name),onClick:t[0]||(t[0]=t=>e.$emit("select"))},null,10,Yt),s.selected?((0,i.wg)(),(0,i.iD)("div",Lt,[(0,i._)("div",Ut,[Ht,(0,i._)("div",Pt,[(0,i._)("form",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.devices,((e,t)=>((0,i.wg)(),(0,i.iD)("label",{class:"row",key:t},[(0,i._)("input",{type:"checkbox",checked:o.members.has(e.ieee_address),value:e.ieee_address,onChange:t=>o.toggleDevice(e.ieee_address)},null,40,Xt),(0,i._)("span",{class:"label",textContent:(0,a.zw)(e.friendly_name?.length?e.friendly_name:e.ieee_address)},null,8,Wt)])))),128))])])]),(0,i._)("div",Jt,[Kt,(0,i._)("div",Qt,[(0,i._)("div",{class:"row",onClick:t[1]||(t[1]=(...e)=>o.rename&&o.rename(...e))},ss),(0,i._)("div",{class:"row",onClick:t[2]||(t[2]=(...e)=>o.remove&&o.remove(...e))},ns)])])])):(0,i.kq)("",!0)],2)}var os={name:"Group",emits:["select","remove","edit"],mixins:[ae.Z],components:{Loading:ie.Z},props:{group:{type:Object,required:!0},devices:{type:Object,default:()=>({})},selected:{type:Boolean,default:!1}},data(){return{loading:!1,values:{}}},computed:{devicesByAddress(){return Object.entries(this.devices).reduce(((e,t)=>{const s=t[1];return e[s.ieee_address]=s,e}),{})},members(){return new Set((this.group.members||[]).map((e=>e.ieee_address)))}},methods:{async remove(){if(confirm("Are you sure that you want to remove this group?")){this.loading=!0;try{await this.request("zigbee.mqtt.group_remove",{name:this.group.friendly_name}),this.$emit("remove",{name:this.group.friendly_name})}finally{this.loading=!1}}},async rename(){let e=prompt("New group name",this.group.friendly_name);if(e?.length){e=e.trim(),this.loading=!0;try{await this.request("zigbee.mqtt.group_rename",{group:this.group.friendly_name||this.group.id,name:e}),this.$emit("rename",{name:this.group.friendly_name,newName:e})}finally{this.loading=!1}}},async toggleDevice(e){const t=this.devicesByAddress[e],s=t.friendly_name?.length?t.friendly_name:e,i=this.members.has(e)?"remove":"add";this.loading=!0;try{await this.request(`zigbee.mqtt.group_${i}_device`,{group:this.group.friendly_name,device:s}),this.$emit("edit",{device:s,method:i})}finally{this.loading=!1}}}};const rs=(0,$t.Z)(os,[["render",ls],["__scopeId","data-v-7667f7ba"]]);var ds=rs,us={name:"ZigbeeMqtt",components:{Modal:At.Z,Dropdown:te.Z,DropdownItem:se.Z,Loading:ie.Z,Device:Ft,Group:ds},mixins:[ae.Z],data(){return{devices:{},groups:{},status:{},loading:!1,selected:{view:"devices",deviceId:void 0,groupId:void 0},views:{devices:!0,groups:!0},modal:{group:{visible:!1}}}},methods:{async refreshDevices(){this.loading=!0;try{this.devices=(await this.request("zigbee.mqtt.devices")).reduce(((e,t)=>(t.friendly_name in this.devices&&(t={values:this.devices[t.friendly_name].values||{},...this.devices[t.friendly_name]}),e[t.friendly_name]=t,e)),{})}finally{this.loading=!1}},async refreshGroups(){this.loading=!0;try{this.groups=(await this.request("zigbee.mqtt.groups")).reduce(((e,t)=>(e[t.id]=t,e)),{})}finally{this.loading=!1}},async refreshInfo(){this.loading=!0;try{this.status=await this.request("zigbee.mqtt.info")}finally{this.loading=!1}},refresh(){this.refreshDevices(),this.refreshGroups(),this.refreshInfo()},updateProperties(e,t){this.devices[e].values=t},async addGroup(){const e=prompt("Group name");if(e&&e.length){this.loading=!0;try{await this.request("zigbee.mqtt.group_add",{name:e})}finally{this.loading=!1}await this.refreshGroups()}},async permitJoin(e){const t={permit:!!e};if(e){let e=prompt("Join allow period in seconds (0 or empty for no time limits)","60");t.seconds=e.length?parseInt(e):null}this.loading=!0;try{await this.request("zigbee.mqtt.permit_join",t),setTimeout(this.refreshInfo,1e3)}finally{this.loading=!1}},async factoryReset(){if(confirm("Are you SURE that you want to do a device factory reset?")||confirm("Are you REALLY sure? ALL network information and custom firmware will be lost!!")){this.loading=!0;try{await this.request("zigbee.mqtt.factory_reset")}finally{this.loading=!1}}},async addToGroup(e,t){this.loading=!0,await this.request("zigbee.mqtt.group_add_device",{device:e,group:t}),this.loading=!1;const s=this;setTimeout((()=>{s.refresh(),s.refreshGroups()}),100)}},created(){this.subscribe((()=>{this.notify({text:"WARNING: The controller is offline",error:!0})}),"on-zigbee-offline","platypush.message.event.zigbee.mqtt.ZigbeeMqttOfflineEvent"),this.subscribe((()=>{this.notify({text:"The controller is now online",iconClass:"fas fa-check"})}),"on-zigbee-online","platypush.message.event.zigbee.mqtt.ZigbeeMqttOnlineEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove the device",error:!0})}),"on-zigbee-device-remove-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRemovedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to add the group",error:!0})}),"on-zigbee-group-add-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupAddedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove group",error:!0})}),"on-zigbee-group-remove-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemovedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove the devices from group",error:!0})}),"on-zigbee-remove-all-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemoveAllFailedEvent"),this.subscribe((e=>{this.notify({text:e.error||"[Unknown error]",error:!0})}),"on-zigbee-error","platypush.message.event.zigbee.mqtt.ZigbeeMqttErrorEvent"),this.subscribe(this.refresh,"on-zigbee-device-update","platypush.message.event.zigbee.mqtt.ZigbeeMqttOnlineEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDevicePairingEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceConnectedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceBannedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRemovedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceWhitelistedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRenamedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceBindEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceUnbindEvent"),this.subscribe(this.refreshGroups,"on-zigbee-group-update","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupAddedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemovedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemoveAllEvent")},mounted(){this.refresh()},unmounted(){this.unsubscribe("on-zigbee-error"),this.unsubscribe("on-zigbee-remove-all-failed"),this.unsubscribe("on-zigbee-group-remove-failed"),this.unsubscribe("on-zigbee-group-add-failed"),this.unsubscribe("on-zigbee-device-remove-failed"),this.unsubscribe("on-zigbee-online"),this.unsubscribe("on-zigbee-offline"),this.unsubscribe("on-zigbee-device-update"),this.unsubscribe("on-zigbee-group-update")}};const cs=(0,$t.Z)(us,[["render",ee]]);var vs=cs}}]);
//# sourceMappingURL=4604.f2e36363.js.map
